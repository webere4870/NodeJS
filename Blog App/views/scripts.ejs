<script>
    let newPost = async () =>
    {
        let title = $('#blogTitle')
        let caption = $('#blogCaption')
        let keywords = $('#blogKeywords')
        const keywordsArr = keywords.split(" ")
        const article = document.querySelector('#blogArticle')
        let response = await fetch('/write/newBlog', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({title: title.value, caption: caption.value, keywords: keywordsArr, article: article.value})
        })
        let json = await response.json()
        console.log(json);
        title.value =""
        keywords.value = ""
        article.value =""
        caption.value =""
    }

    const $ = (query) => document.querySelector(query)

    const getLikes = async (title) =>
    {
        console.log("here");
        let response = await fetch('/likes/' + title, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({title: title})
        })
        console.log(response);
        let {likes} = await response.json();
        let likeCount = $('#likeCount')
        let newText = document.createTextNode(likes);
        likeCount.appendChild(newText);
    }

    const getArticle = async (title) =>
    {
        let article = await fetch('/article');
    }

    const upLikes = async (title) =>
    {
        let iconDivs = document.querySelectorAll('.iconCircle');
        if(iconDivs[0].classList.contains("unliked"))
        {
            iconDivs[0].classList.toggle("unliked")
            iconDivs[0].classList.toggle("liked")
            iconDivs[0].querySelector('i').classList.toggle("likedI")
            let response = await fetch('/likes/' + title, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({title: title})
            })
            let {likes} = await response.json();
            let likeCount = $('#likeCount')
            let newText = document.createTextNode(likes);
            likeCount.textContent = "";
            likeCount.appendChild(newText);
        }
        else
        {
            iconDivs[0].classList.toggle("unliked")
            iconDivs[0].classList.toggle("liked")
            iconDivs[0].querySelector('i').classList.toggle("likedI")
            let response = await fetch('/downLikes/' + title, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({title: title})
            })
            let {likes} = await response.json();
            console.log(likes);
            let likeCount = $('#likeCount')
            let newText = document.createTextNode(likes);
            likeCount.textContent = "";
            likeCount.appendChild(newText);
        }
    }

    const loadComments = () =>
    {
        let myDiv = document.querySelectorAll('.colorMe')
        let xBtn = document.querySelectorAll('.closeBtn')
        xBtn[0].classList.toggle("hide")
        myDiv[0].classList.toggle("open");
    }

    document.querySelector("#postComment").addEventListener("click",
    async ()=>
    {
        console.log("here")
        let response = await fetch('/newCommenter/' + title, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({title: title})
            })
        console.log("her3");
        const newby = await response.json();
        console.log(newby);
    })

</script>

<!-- let newComment = document.querySelector('#newComment')
        let hiddenBox = document.querySelector('#hiddenBox')
        let object = {comment: newComment, title: hiddenBox.value}
        const response = await fetch('/newComment',
        {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(object)
        })
        const jsonn = await response.json();
        console.log(jsonn); -->